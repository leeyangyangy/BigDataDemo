**任务五：HDFS数据读过程**

**3.5.1实训平台**

1.操作系统：Ubuntu-20.04 

2.Hadoop版本：hadoop-3.3.4.tar.gz 

3.JDK 版本：1.8 JAVA IDE：Idea

 

**3.5.2 实训内容**

1. **(一) 编程实现以下指定功能，并利用Hadoop提供的Shell命令完成相同的任务**

- 1. 向HDFS中上传任意文本文件，如果指定的文件在HDFS中已经存在，有用户指定的是追加到原有文件末尾还是覆盖原有的文件。
  2. 从HDFS中下载指定文件，如果本地文件与要下载的文件名称相同，则自动对下载的文件重命名。
  3. 将HDFS中指定文件的内容输出到终端。
  4. 显示HDFS中指定的文件的读写权限、大小、创建时间、路径等信息。
  5. 给定HDFS中某一个目录，输出该目录下的所有文件的读写权限、大小、创建时间、路径等信息，
  6. 如果该文件是目录，则递归输出该目录下所有文件相关信息。
  7. 提供一个HDFS内的文件的路径，对该文件进行创建和删除操作。如果文件所在目录不存在，则
  8. 自动创建目录。
  9. 提供一个HDFS的目录的路径，对该目录进行创建和删除操作。创建目录时，如果目录文件所在
  10. 目录不存在则自动创建相应目录。删除目录时，由用户指定当该目录不为空时是否还删除该目录。
  11. 向HDFS中指定的文件追加内容，由用户指定内容追加到原有文件的开头或结尾。
  12. 删除HDFS中指定的文件。
  13. 删除HDFS中指定的目录，由用户指定目录中如果存在文件时是否删除目录。
  14. 在HDFS中，将文件从源路径移动到目的路径。

 

1. **(二)  编程实现一个类“MyFSDataInputStream”，该类继承“org. apache.hadoop.fs. FSData Input Stream" ,要求如下:实现按行读取HDFS中指定文件的方法“readLine0",如果读到文件末尾，则返回空，否则返回文件- -行的文本。**

- 1. 实现按行读取HDFS中指定文件的方法“readLine0",如果读到文件末尾，则返回为空，否则返回文件一行文本。
  2. 2)实现缓存功能，即利用“MyFSDataInputStream” 读取若干字节数据时，首先查找缓存，如果缓存
  3. 中有所需的数据，则直接由缓存提供，否则向HDFS读取数据。
  4. 3.查看Java帮助手册或其它资料，用“java.net.URL” 和“orgapache.hadoop.fs.FsURL
  5. StreamHandlerFactory”编程完成输出HDFS中指定文件的文本到终端中。

 

 

**3.5.3实验过程与结论: (经调试正确的源程序(核心部分)和程序的运行结果)**

**(一)编程实现以下指定功能，并利用Hadoop提供的Shell命令完成相同的任务。**

- 1. 向HDFS中上传任意文本文件，如果指定的文件在HDFS中已经存在，有用户指定的是追加到      原有文件末尾还是覆盖原有的文件。
  2. 从HDFS中下载指定文件，如果本地文件与要下载的文件名称相同，则自动对下载的文件重命名
  3. 将HDFS中指定文件的内容输出到终端中
  4. 显示HDFS中指定的文件的读写权限、大小、创建时间、路径等信息
  5. 给定HDFS中某一个目录，输出该目录的所有文件的读写权限、大小、创建时间、路径等信息，如果该文件是目录，则递归输出该目录下所有文件相关信息
  6. 提供一个HDFS内的文件的路径，对该文件进行创建和删除操作。如果文件所在目录不存在，则自动创建目录
  7. 提供一个HDFS的目录的路径，对该目录进行创建和删除操作。创建目录时，如果目录文件所在目录不存在则自动创建相应目录。删除目录时，由用户指定当该目录不为空时是否还删除该目录。
  8. 向HDFS中指定的文件追加内容由用户指定内容追加到原有文件的开头或结尾。
  9. 删除HDFS中指定的文件
  10. 删除HDFS中指定的目录，由用户指定目录中如果存在文件时是否删除目录。
  11. 在HDFS中，将文件从源路径移动到目的路径。

 

 

**(二) 编程实现一个类"MyFSDataInputStream", 该类继承“org.apache .hadoop.fs.FSData InputStream”, 要求如下:实现按行读取HDFS中指定文件的方法“readLine0", 如果读到文件末尾，则返回空，否则返回文件- -行的文本**

**3.5.4实验总结: (实验中遇到的问题及解决方法,心得体会等任务**

通过Shell命令完成了HDFS实现文件的显示、读取、删除和编辑等操作 通过Java API完成了HDFS实现文件的显示、读取、删除和编辑等操作 通过实训完成，可以看出Hadoop采用流数据读写，适用于大数据集，适用Shell命令和Java API可以 很方便的对分布式文件进行管理和维护，具备很好的容错性。

**HDFS数据读过程**

| 评分点                               | 分数 | 说明                                                         |
| ------------------------------------ | ---- | ------------------------------------------------------------ |
| 搭建项目服务                         | 5    | 搭建商户平台应用程序和商户服务工程                           |
| 工程测试                             | 5    | 配置及其接口，实现，应用层                                   |
| HDFS数据读过程系统分析               | 5    | 系统分析以及结构安排                                         |
| Hadoop提供的Shell命令完成相同的任务  | 10   | 完成对应的任务1-5                                            |
| Hadoop提供的Shell命令完成相同的任务  | 10   | 完成对应的任务6-8                                            |
| Hadoop提供的Shell命令完成相同的任务  | 10   | 完成对应的任务8-10                                           |
| 编程实现一个类"MyFSDataInputStream", | 10   | 实现按行读取HDFS中指定文件的方法“readLine0", 如果读到文件末尾，则返回空，否则返回文件- -行的文本 |
| 编码规范                             | 5    | 各种命名符合规范，必要注释                                   |
| 项目整体                             | 10   | 项目正常运行部署，业务板块基本正常，设计功能整体实现         |
| 课程设计报告                         | 30   | 符合一般论文格式规范。                                       |

**五、交付清单**

| **序号** | **阶段目标** | **提交物**                                                   | **提交人**       |          |
| -------- | ------------ | ------------------------------------------------------------ | ---------------- | -------- |
| 1        | 项目需求分析 | 熟悉企业系统设计文档规范和系统设计工具，掌握设计方法，提交系统设计说明书 | 项目需求分析文档 | 学生     |
| 2        | 项目源码     | 提交实现的效果代码，每个人需要提交，每组也需要提交整个小组的完整版 | 项目源码         | 学生     |
| 3        | 结果         | 总结                                                         | 任务成绩         | 项目经理 |